var e=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire55a5;e.register("hsMrW",(function(r,t){var n,a,o,s;n=r.exports,a="joinRoom",o=function(){return he},Object.defineProperty(n,a,{get:o,set:s,enumerable:!0,configurable:!0});var i,c,l,d,u,f,p,y,m,w,v,g,h,b,k,P,T,A,S=e("dM3DM"),D=e("aQXMn");const{floor:L,random:I}=Math,$="Trystero",E=(e,r)=>Array(e).fill().map(r),C=e=>E(e,(()=>"0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"[L(62*I())])).join(""),U=C(20),_=Promise.all.bind(Promise),j="undefined"!=typeof window,{entries:O,fromEntries:M,keys:H}=Object,R=()=>{},J=e=>Error(`${$}: ${e}`),x=new TextEncoder,q=new TextDecoder,B=e=>x.encode(e),G=e=>q.decode(e),N=(...e)=>e.join("@"),W=JSON.stringify,z=JSON.parse,K={},Q="AES-GCM",V={},X=async e=>V[e]||(V[e]=Array.from(new Uint8Array(await crypto.subtle.digest("SHA-1",B(e)))).map((e=>e.toString(36))).join("")),F=async(e,r)=>{const t=crypto.getRandomValues(new Uint8Array(16));var n;return t.join(",")+"$"+(n=await crypto.subtle.encrypt({name:Q,iv:t},await e,B(r)),btoa(String.fromCharCode.apply(null,new Uint8Array(n))))},Y=async(e,r)=>{const[t,n]=r.split("$");return G(await crypto.subtle.decrypt({name:Q,iv:new Uint8Array(t.split(","))},await e,(e=>{const r=atob(e);return new Uint8Array(r.length).map(((e,t)=>r.charCodeAt(t))).buffer})(n)))},Z="icegatheringstatechange",ee="offer";var re=(e,{rtcConfig:r,rtcPolyfill:t,turnConfig:n})=>{const a=new(t||RTCPeerConnection)((0,S.default)({iceServers:te.concat(n||[])},r)),o={};let s=!1,i=!1,c=null;const l=e=>{e.binaryType="arraybuffer",e.bufferedAmountLowThreshold=65535,e.onmessage=e=>{var r;return null===(r=o.data)||void 0===r?void 0:r.call(o,e.data)},e.onopen=()=>{var e;return null===(e=o.connect)||void 0===e?void 0:e.call(o)},e.onclose=()=>{var e;return null===(e=o.close)||void 0===e?void 0:e.call(o)},e.onerror=e=>{var r;return null===(r=o.error)||void 0===r?void 0:r.call(o,e)}},d=e=>Promise.race([new Promise((r=>{const t=()=>{"complete"===e.iceGatheringState&&(e.removeEventListener(Z,t),r())};e.addEventListener(Z,t),t()})),new Promise((e=>setTimeout(e,5e3)))]).then((()=>({type:e.localDescription.type,sdp:e.localDescription.sdp.replace(/a=ice-options:trickle\s\n/g,"")})));return e?(c=a.createDataChannel("data"),l(c)):a.ondatachannel=({channel:e})=>{c=e,l(e)},a.onnegotiationneeded=async()=>{try{var e;s=!0,await a.setLocalDescription();const r=await d(a);null===(e=o.signal)||void 0===e||e.call(o,r)}catch(e){var r;null===(r=o.error)||void 0===r||r.call(o,e)}finally{s=!1}},a.onconnectionstatechange=()=>{var e;["disconnected","failed","closed"].includes(a.connectionState)&&(null===(e=o.close)||void 0===e||e.call(o))},a.ontrack=e=>{var r,t;null===(r=o.track)||void 0===r||r.call(o,e.track,e.streams[0]),null===(t=o.stream)||void 0===t||t.call(o,e.streams[0])},a.onremovestream=e=>{var r;return null===(r=o.stream)||void 0===r?void 0:r.call(o,e.stream)},e&&(a.canTrickleIceCandidates||a.onnegotiationneeded()),{created:Date.now(),connection:a,get channel(){return c},get isDead(){return"closed"===a.connectionState},async signal(r){var t;if("open"!==(null==c?void 0:c.readyState)||(null===(t=r.sdp)||void 0===t?void 0:t.includes("a=rtpmap")))try{if(r.type===ee){var n;if(s||"stable"!==a.signalingState&&!i){if(e)return;await _([a.setLocalDescription({type:"rollback"}),a.setRemoteDescription(r)])}else await a.setRemoteDescription(r);await a.setLocalDescription();const t=await d(a);return null===(n=o.signal)||void 0===n||n.call(o,t),t}if("answer"===r.type){i=!0;try{await a.setRemoteDescription(r)}finally{i=!1}}}catch(e){var l;null===(l=o.error)||void 0===l||l.call(o,e)}},sendData:e=>c.send(e),destroy(){null==c||c.close(),a.close(),s=!1,i=!1},setHandlers:e=>Object.assign(o,e),offerPromise:e?new Promise((e=>o.signal=r=>{r.type===ee&&e(r)})):Promise.resolve(),addStream:e=>e.getTracks().forEach((r=>a.addTrack(r,e))),removeStream:e=>a.getSenders().filter((r=>e.getTracks().includes(r.track))).forEach((e=>a.removeTrack(e))),addTrack:(e,r)=>a.addTrack(e,r),removeTrack(e){const r=a.getSenders().find((r=>r.track===e));r&&a.removeTrack(r)},replaceTrack(e,r){const t=a.getSenders().find((r=>r.track===e));if(t)return t.replaceTrack(r)}}};const te=[...E(3,((e,r)=>`stun:stun${r||""}.l.google.com:19302`)),"stun:stun.cloudflare.com:3478"].map((e=>({urls:e}))),ne=Object.getPrototypeOf(Uint8Array),ae=16369,oe=255,se="bufferedamountlow",ie=e=>"@_"+e,ce={},le={},de={},ue={},fe={},pe={},ye={},me={},we=async e=>{if(le[e])return le[e];const r=(await X(e)).slice(0,20);return le[e]=r,de[r]=e,r},ve=async(e,r,t)=>e.send(W((0,S.default)({action:"announce",info_hash:await we(r),peer_id:U},t))),ge=(e,r,t)=>console.warn(`${$}: torrent tracker ${t?"failure":"warning"} from ${e} - ${r}`),he=(({init:e,subscribe:r,announce:t})=>{const n={};let a,o,s,h=!1;return(b,k,P)=>{var T;const{appId:A}=b;if(null===(T=n[A])||void 0===T?void 0:T[k])return n[A][k];const L={},I={},C=N($,A,k),x=X(C),q=X(N(C,U)),K=(async(e,r,t)=>crypto.subtle.importKey("raw",await crypto.subtle.digest({name:"SHA-256"},B(`${e}:${r}:${t}`)),{name:Q},!1,["encrypt","decrypt"]))(b.password||"",A,k),V=e=>async r=>({type:r.type,sdp:await e(K,r.sdp)}),Z=V(Y),ee=V(F),te=()=>re(!0,b),ce=(e,r,t)=>{var n;I[r]?I[r]!==e&&e.destroy():(I[r]=e,me(e,r),null===(n=L[r])||void 0===n||n.forEach(((e,r)=>{r!==t&&e.destroy()})),delete L[r])},le=(e,r)=>{I[r]===e&&delete I[r]},de=e=>(o.push(...E(e,te)),_(o.splice(0,e).map((e=>e.offerPromise.then(ee).then((r=>({peer:e,offer:r}))))))),ue=(e,r)=>null==P?void 0:P({error:`incorrect password (${b.password}) when decrypting ${r}`,appId:A,peerId:e,roomId:k});if(!b)throw J("requires a config map as the first argument");if(!A&&!b.firebaseApp)throw J("config map is missing appId field");if(!k)throw J("roomId argument required");if(!h){const r=e(b);o=E(20,te),a=Array.isArray(r)?r:[r],h=!0,s=setInterval((()=>o=o.filter((e=>{const r=Date.now()-e.created<57333;return r||e.destroy(),r}))),59052.99)}const fe=a.map((()=>5333)),pe=[],ye=a.map((async(e,t)=>r(await e,await x,await q,(e=>async(r,t,n)=>{const[a,o]=await _([x,q]);if(r!==a&&r!==o)return;const{peerId:s,offer:l,answer:d,peer:u}="string"==typeof t?z(t):t;if(s!==U&&!I[s])if(!s||l||d){if(l){var f;if((null===(f=L[s])||void 0===f?void 0:f[e])&&U>s)return;const r=re(!1,b);let t;r.setHandlers({connect:()=>ce(r,s,e),close:()=>le(r,s)});try{t=await Z(l)}catch(e){return void ue(s,"offer")}if(r.isDead)return;const[a,o]=await _([X(N(C,s)),r.signal(t)]);n(a,W({peerId:U,answer:await ee(o)}))}else if(d){let r;try{r=await Z(d)}catch(e){return void ue(s,"answer")}if(u)u.setHandlers({connect:()=>ce(u,s,e),close:()=>le(u,s)}),u.signal(r);else{var p;const t=null===(p=L[s])||void 0===p?void 0:p[e];t&&!t.isDead&&t.signal(r)}}}else{var y;if(null===(y=L[s])||void 0===y?void 0:y[e])return;const[[{peer:r,offer:t}],a]=await _([de(1),X(N(C,s))]);(i=L)[c=s]||(i[c]=[]),L[s][e]=r,setTimeout((()=>((e,r)=>{var t;if(I[e])return;const n=null===(t=L[e])||void 0===t?void 0:t[r];n&&(delete L[e][r],n.destroy())})(s,e)),.9*fe[e]),r.setHandlers({connect:()=>ce(r,s,e),close:()=>le(r,s)}),n(a,W({peerId:U,offer:t}))}})(t),de)));_([x,q]).then((([e,r])=>{const n=async(a,o)=>{const s=await t(a,e,r);"number"==typeof s&&(fe[o]=s),pe[o]=setTimeout((()=>n(a,o)),fe[o])};ye.forEach((async(e,r)=>{await e,n(await a[r],r)}))}));let me=R;return(l=n)[d=A]||(l[d]={}),n[A][k]=((e,r,t)=>{const n={},a={},o={},s={},i={},c={},l={},d={onPeerJoin:R,onPeerLeave:R,onPeerStream:R,onPeerTrack:R},h=(e,r)=>(e?Array.isArray(e)?e:[e]:H(n)).flatMap((e=>{const t=n[e];return t?r(e,t):(console.warn(`${$}: no peer with id ${e} found`),[])})),b=e=>{n[e]&&(delete n[e],delete s[e],delete i[e],d.onPeerLeave(e),r(e))},k=e=>{if(a[e])return o[e];if(!e)throw J("action type argument is required");const r=B(e);if(r.byteLength>12)throw J(`action type string "${e}" (${r.byteLength}b) exceeds byte limit (12). Hint: choose a shorter name.`);const t=new Uint8Array(12);t.set(r);let s=0;return a[e]={onComplete:R,onProgress:R,setOnComplete:r=>a[e]=(0,D.default)((0,S.default)({},a[e]),{onComplete:r}),setOnProgress:r=>a[e]=(0,D.default)((0,S.default)({},a[e]),{onProgress:r}),async send(e,r,a,o){if(a&&"object"!=typeof a)throw J("action meta argument must be an object");const i=typeof e;if("undefined"===i)throw J("action data cannot be undefined");const c="string"!==i,l=e instanceof Blob,d=l||e instanceof ArrayBuffer||e instanceof ne;if(a&&!d)throw J("action meta argument can only be used with binary data");const u=d?new Uint8Array(l?await e.arrayBuffer():e):B(c?W(e):e),f=a?B(W(a)):null,p=Math.ceil(u.byteLength/ae)+(a?1:0)||1,y=E(p,((e,r)=>{const n=r===p-1,o=a&&0===r,i=new Uint8Array(15+(o?f.byteLength:n?u.byteLength-ae*(p-(a?2:1)):ae));return i.set(t),i.set([s],12),i.set([n|o<<1|d<<2|c<<3],13),i.set([Math.round((r+1)/p*oe)],14),i.set(a?o?f:u.subarray((r-1)*ae,r*ae):u.subarray(r*ae,(r+1)*ae),15),i}));return s=s+1&oe,_(h(r,(async(e,r)=>{const{channel:t}=r;let s=0;for(;s<p;){const i=y[s];if(t.bufferedAmount>t.bufferedAmountLowThreshold&&await new Promise((e=>{const r=()=>{t.removeEventListener(se,r),e()};t.addEventListener(se,r)})),!n[e])break;r.sendData(i),s++,null==o||o(i[14]/oe,e,a)}})))}},(u=o)[f=e]||(u[f]=[a[e].send,a[e].setOnComplete,a[e].setOnProgress])},P=(e,r)=>{const t=new Uint8Array(r),n=G(t.subarray(0,12)).replaceAll("\0",""),[o]=t.subarray(12,13),[i]=t.subarray(13,14),[c]=t.subarray(14,15),l=t.subarray(15),d=!!(1&i),u=!!(2&i),f=!!(4&i),h=!!(8&i);if(!a[n])return void console.warn(`${$}: received message with unregistered type (${n})`);(p=s)[y=e]||(p[y]={}),(m=s[e])[w=n]||(m[w]={});const b=(v=s[e][n])[g=o]||(v[g]={chunks:[]});if(u?b.meta=z(G(l)):b.chunks.push(l),a[n].onProgress(c/oe,e,b.meta),!d)return;const k=new Uint8Array(b.chunks.reduce(((e,r)=>e+r.byteLength),0));if(b.chunks.reduce(((e,r)=>(k.set(r,e),e+r.byteLength)),0),delete s[e][n][o],f)a[n].onComplete(k,e,b.meta);else{const r=G(k);a[n].onComplete(h?z(r):r,e)}},T=async()=>{await V(""),await new Promise((e=>setTimeout(e,99))),O(n).forEach((([e,r])=>{r.destroy(),delete n[e]})),t()},[A,L]=k(ie("ping")),[I,C]=k(ie("pong")),[U,x]=k(ie("signal")),[q,N]=k(ie("stream")),[K,Q]=k(ie("track")),[V,X]=k(ie("leave"));return(e=>{me=e})(((e,r)=>{var t;n[r]||(n[r]=e,e.setHandlers({data:e=>P(r,e),stream(e){d.onPeerStream(e,r,c[r]),delete c[r]},track(e,t){d.onPeerTrack(e,t,r,l[r]),delete l[r]},signal:e=>U(e,r),close:()=>b(r),error(e){console.error(e),b(r)}}),d.onPeerJoin(r),null===(t=e.drainEarlyData)||void 0===t||t.call(e,(e=>P(r,e))))})),L(((e,r)=>I("",r))),C(((e,r)=>{var t;null===(t=i[r])||void 0===t||t.call(i),delete i[r]})),x(((e,r)=>{var t;return null===(t=n[r])||void 0===t?void 0:t.signal(e)})),N(((e,r)=>c[r]=e)),Q(((e,r)=>l[r]=e)),X(((e,r)=>b(r))),j&&addEventListener("beforeunload",T),{makeAction:k,leave:T,async ping(e){if(!e)throw J("ping() must be called with target peer ID");const r=Date.now();return A("",e),await new Promise((r=>i[e]=r)),Date.now()-r},getPeers:()=>M(O(n).map((([e,r])=>[e,r.connection]))),addStream:(e,r,t)=>h(r,(async(r,n)=>{t&&await q(t,r),n.addStream(e)})),removeStream:(e,r)=>h(r,((r,t)=>t.removeStream(e))),addTrack:(e,r,t,n)=>h(t,(async(t,a)=>{n&&await K(n,t),a.addTrack(e,r)})),removeTrack:(e,r)=>h(r,((r,t)=>t.removeTrack(e))),replaceTrack:(e,r,t,n)=>h(t,(async(t,a)=>{n&&await K(n,t),a.replaceTrack(e,r)})),onPeerJoin:e=>d.onPeerJoin=e,onPeerLeave:e=>d.onPeerLeave=e,onPeerStream:e=>d.onPeerStream=e,onPeerTrack:e=>d.onPeerTrack=e}})(0,(e=>delete I[e]),(()=>{delete n[A][k],pe.forEach(clearTimeout),ye.forEach((async e=>(await e)())),clearInterval(s)}))}})({init:e=>((e,r,t)=>(e.relayUrls||r).slice(0,e.relayUrls?e.relayUrls.length:e.relayRedundancy||3))(e,ke).map((e=>{const r=((e,r)=>{const t={},n=()=>{const a=new WebSocket(e);a.onclose=()=>{var r;null!==(r=(h=K)[b=e])&&void 0!==r||(h[b]=3333),setTimeout(n,K[e]),K[e]*=2},a.onmessage=e=>r(e.data),t.socket=a,t.url=a.url,t.ready=new Promise((r=>a.onopen=()=>{r(t),K[e]=3333})),t.send=e=>{1===a.readyState&&a.send(e)}};return n(),t})(e,(e=>{const r=z(e),n=r["failure reason"],a=r["warning message"],{interval:o}=r,s=de[r.info_hash];if(n)ge(t,n,!0);else{var i,c;if(a&&ge(t,a),o&&1e3*o>pe[t]&&fe[t][s]){const e=Math.min(1e3*o,120333);clearInterval(ue[t][s]),pe[t]=e,ue[t][s]=setInterval(fe[t][s],e)}ye[r.offer_id]||(r.offer||r.answer)&&(ye[r.offer_id]=!0,null===(c=(i=me[t])[s])||void 0===c||c.call(i,r))}})),{url:t}=r;return ce[t]=r,me[t]={},r.ready})),subscribe(e,r,t,n,a){const{url:o}=e,s=async()=>{const t=M((await a(10)).map((e=>[C(20),e])));me[e.url][r]=a=>{if(a.offer)n(r,{offer:a.offer,peerId:a.peer_id},((t,n)=>ve(e,r,{answer:z(n).answer,offer_id:a.offer_id,to_peer_id:a.peer_id})));else if(a.answer){const e=t[a.offer_id];e&&n(r,{answer:a.answer,peerId:a.peer_id,peer:e.peer})}},ve(e,r,{numwant:10,offers:O(t).map((([e,{offer:r}])=>({offer_id:e,offer:r})))})};return pe[o]=33333,(k=fe)[P=o]||(k[P]={}),fe[o][r]=s,(T=ue)[A=o]||(T[A]={}),ue[o][r]=setInterval(s,pe[o]),s(),()=>{clearInterval(ue[o][r]),delete me[o][r],delete fe[o][r]}},announce:e=>pe[e.url]});be=ce;var be;const ke=["tracker.webtorrent.dev","tracker.openwebtorrent.com","tracker.btorrent.xyz","tracker.files.fm:7073/announce"].map((e=>"wss://"+e))}));