!function(){var e=("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire55a5;e.register("1UDrq",(function(n,t){var r,a,i,o;r=n.exports,a="joinRoom",i=function(){return jn},Object.defineProperty(r,a,{get:i,set:o,enumerable:!0,configurable:!0});var u,c,f,s,l,d,h,v,y,p,g,m,w,b,E,k,x=e("hnmIs"),A=e("9Klpk"),S=e("3bWnf"),_=e("eT7f3"),I=e("kb0qF"),P=e("bgoEC"),B=e("7j4mF"),T=e("5ENmm"),H=e("6Wo7Q"),U=e("rJmE6"),R=e("fSF4h"),C=e("bWNdT"),D=e("32Euv"),z=Object.freeze({__proto__:null,default:{}}),O=BigInt(0),N=BigInt(1),L=BigInt(2),j=BigInt(3),M=BigInt(8),Z=Object.freeze({a:O,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),V=function(e,n){return(e+n/L)/n},q=BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),W=function(e){var n=Z.n,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-N*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=t,o=BigInt("0x100000000000000000000000000000000"),u=V(i*e,n),c=V(-r*e,n),f=me(e-u*t-c*a,n),s=me(-u*r-c*i,n),l=f>o,d=s>o;if(l&&(f=n-f),d&&(s=n-s),f>o||s>o)throw Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:l,k1:f,k2neg:d,k2:s}},K=32;function F(e){var n=Z.a,t=Z.b,r=me(e*e),a=me(r*e);return me(a+n*e+t)}var J=Z.a===O,G=function(e){"use strict";(0,I.default)(t,e);var n=(0,C.default)(t);function t(e){return(0,A.default)(this,t),n.call(this,e)}return t}((0,R.default)(Error));function X(e){if(!(e instanceof Y))throw new TypeError("JacobianPoint expected")}var Y=function(){"use strict";function e(n,t,r){(0,A.default)(this,e),this.x=n,this.y=t,this.z=r}return(0,S.default)(e,[{key:"equals",value:function(e){X(e);var n=this,t=n.x,r=n.y,a=n.z,i=e.x,o=e.y,u=e.z,c=me(a*a),f=me(u*u),s=me(t*f),l=me(i*c),d=me(me(r*u)*f),h=me(me(o*a)*c);return s===l&&d===h}},{key:"negate",value:function(){return new e(this.x,me(-this.y),this.z)}},{key:"double",value:function(){var n=this,t=n.x,r=n.y,a=n.z,i=me(t*t),o=me(r*r),u=me(o*o),c=t+o,f=me(L*(me(c*c)-i-u)),s=me(j*i),l=me(s*s),d=me(l-L*f);return new e(d,me(s*(f-d)-M*u),me(L*r*a))}},{key:"add",value:function(n){X(n);var t=this,r=t.x,a=t.y,i=t.z,o=n.x,u=n.y,c=n.z;if(o===O||u===O)return this;if(r===O||a===O)return n;var f=me(i*i),s=me(c*c),l=me(r*s),d=me(o*f),h=me(me(a*c)*s),v=me(me(u*i)*f),y=me(d-l),p=me(v-h);if(y===O)return p===O?this.double():e.ZERO;var g=me(y*y),m=me(y*g),w=me(l*g),b=me(p*p-m-L*w);return new e(b,me(p*(w-b)-h*m),me(i*c*y))}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"multiplyUnsafe",value:function(n){var t=e.ZERO;if("bigint"==(void 0===n?"undefined":(0,U.default)(n))&&n===O)return t;var r=ge(n);if(r===N)return this;if(!J){for(var a=t,i=this;r>O;)r&N&&(a=a.add(i)),i=i.double(),r>>=N;return a}for(var o=W(r),u=o.k1neg,c=o.k1,f=o.k2neg,s=o.k2,l=t,d=t,h=this;c>O||s>O;)c&N&&(l=l.add(h)),s&N&&(d=d.add(h)),h=h.double(),c>>=N,s>>=N;return u&&(l=l.negate()),f&&(d=d.negate()),d=new e(me(d.x*q),d.y,d.z),l.add(d)}},{key:"precomputeWindow",value:function(e){for(var n=J?128/e+1:256/e+1,t=[],r=this,a=r,i=0;i<n;i++){a=r,t.push(a);for(var o=1;o<Math.pow(2,e-1);o++)a=a.add(r),t.push(a);r=a.double()}return t}},{key:"wNAF",value:function(n,t){!t&&this.equals(e.BASE)&&(t=ee.BASE);var r=t&&t._WINDOW_SIZE||1;if(256%r)throw Error("Point#wNAF: Invalid precomputation window, must be power of 2");var a=t&&$.get(t);a||(a=this.precomputeWindow(r),t&&1!==r&&(a=e.normalizeZ(a),$.set(t,a)));for(var i=e.ZERO,o=e.BASE,u=1+(J?128/r:256/r),c=Math.pow(2,r-1),f=BigInt(Math.pow(2,r)-1),s=Math.pow(2,r),l=BigInt(r),d=0;d<u;d++){var h=d*c,v=Number(n&f);n>>=l,v>c&&(v-=s,n+=N);var y=h,p=h+Math.abs(v)-1,g=d%2!=0,m=v<0;0===v?o=o.add(Q(g,a[y])):i=i.add(Q(m,a[p]))}return{p:i,f:o}}},{key:"multiply",value:function(n,t){var r,a,i=ge(n);if(J){var o=W(i),u=o.k1neg,c=o.k1,f=o.k2neg,s=o.k2,l=this.wNAF(c,t),d=l.p,h=l.f,v=this.wNAF(s,t),y=v.p,p=v.f;d=Q(u,d),y=new e(me((y=Q(f,y)).x*q),y.y,y.z),r=d.add(y),a=h.add(p)}else{var g=this.wNAF(i,t);r=g.p,a=g.f}return e.normalizeZ([r,a])[0]}},{key:"toAffine",value:function(n){var t=this,r=t.x,a=t.y,i=t.z,o=this.equals(e.ZERO);null==n&&(n=o?M:be(i));var u=n,c=me(u*u),f=me(c*u),s=me(r*c),l=me(a*f),d=me(i*u);if(o)return ee.ZERO;if(d!==N)throw Error("invZ was invalid");return new ee(s,l)}}],[{key:"fromAffine",value:function(n){if(!(n instanceof ee))throw new TypeError("JacobianPoint#fromAffine: expected Point");return n.equals(ee.ZERO)?e.ZERO:new e(n.x,n.y,N)}},{key:"toAffineBatch",value:function(e){var n=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.P,t=Array(e.length),r=be(e.reduce((function(e,r,a){return r===O?e:(t[a]=e,me(e*r,n))}),N),n);return e.reduceRight((function(e,r,a){return r===O?e:(t[a]=me(e*t[a],n),me(e*r,n))}),r),t}(e.map((function(e){return e.z})));return e.map((function(e,t){return e.toAffine(n[t])}))}},{key:"normalizeZ",value:function(n){return e.toAffineBatch(n).map(e.fromAffine)}}]),e}();function Q(e,n){var t=n.negate();return e?t:n}Y.BASE=new Y(Z.Gx,Z.Gy,N),Y.ZERO=new Y(O,N,O);var $=new WeakMap,ee=function(){"use strict";function e(n,t){(0,A.default)(this,e),this.x=n,this.y=t}return(0,S.default)(e,[{key:"_setWindowSize",value:function(e){this._WINDOW_SIZE=e,$.delete(this)}},{key:"hasEvenY",value:function(){return this.y%L===O}},{key:"toRawBytes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return ve(this.toHex(e))}},{key:"toHex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=se(this.x);return e?"".concat(this.hasEvenY()?"02":"03").concat(n):"04".concat(n).concat(se(this.y))}},{key:"toHexX",value:function(){return this.toHex(!0).slice(2)}},{key:"toRawX",value:function(){return this.toRawBytes(!0).slice(1)}},{key:"assertValidity",value:function(){var e="Point is not on elliptic curve",n=this.x,t=this.y;if(!ke(n)||!ke(t))throw Error(e);var r=me(t*t);if(me(r-F(n))!==O)throw Error(e)}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"negate",value:function(){return new e(this.x,me(-this.y))}},{key:"double",value:function(){return Y.fromAffine(this).double().toAffine()}},{key:"add",value:function(e){return Y.fromAffine(this).add(Y.fromAffine(e)).toAffine()}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"multiply",value:function(e){return Y.fromAffine(this).multiply(e,this).toAffine()}},{key:"multiplyAndAddUnsafe",value:function(n,t,r){var a=Y.fromAffine(this),i=t===O||t===N||this!==e.BASE?a.multiplyUnsafe(t):a.multiply(t),o=Y.fromAffine(n).multiplyUnsafe(r),u=i.add(o);return u.equals(Y.ZERO)?void 0:u.toAffine()}}],[{key:"fromCompressedHex",value:function(n){var t=32===n.length,r=ye(t?n:n.subarray(1));if(!ke(r))throw Error("Point is not on curve");var a=function(e){var n=Z.P,t=BigInt(6),r=BigInt(11),a=BigInt(22),i=BigInt(23),o=BigInt(44),u=BigInt(88),c=e*e*e%n,f=c*c*e%n,s=we(f,j)*f%n,l=we(s,j)*f%n,d=we(l,L)*c%n,h=we(d,r)*d%n,v=we(h,a)*h%n,y=we(v,o)*v%n,p=we(y,u)*y%n,g=we(p,o)*v%n,m=we(g,j)*f%n,w=we(m,i)*h%n,b=we(w,t)*c%n,E=we(b,L);if(E*E%n!==e)throw Error("Cannot find square root");return E}(F(r)),i=(a&N)===N;t?i&&(a=me(-a)):!(1&~n[0])!==i&&(a=me(-a));var o=new e(r,a);return o.assertValidity(),o}},{key:"fromUncompressedHex",value:function(n){var t=new e(ye(n.subarray(1,33)),ye(n.subarray(33,65)));return t.assertValidity(),t}},{key:"fromHex",value:function(e){var n=pe(e),t=n.length,r=n[0];if(32===t)return this.fromCompressedHex(n);if(33===t&&(2===r||3===r))return this.fromCompressedHex(n);if(65===t&&4===r)return this.fromUncompressedHex(n);throw Error("Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not "+t)}},{key:"fromPrivateKey",value:function(n){return e.BASE.multiply(xe(n))}},{key:"fromSignature",value:function(n,t,r){var a=function(e){if(e instanceof re)return e.assertValidity(),e;try{return re.fromDER(e)}catch(n){return re.fromCompact(e)}}(t),i=a.r,o=a.s;if(![0,1,2,3].includes(r))throw Error("Cannot recover: invalid recovery bit");var u=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=function(e){var n=8*e.length-256,t=ye(e);return n>0?t>>BigInt(n):t}(e);if(n)return t;var r=Z.n;return t>=r?t-r:t}(pe(n)),c=Z.n,f=2===r||3===r?i+c:i,s=be(f,c),l=me(-u*s,c),d=me(o*s,c),h=1&r?"03":"02",v=e.fromHex(h+se(f)),y=e.BASE.multiplyAndAddUnsafe(v,l,d);if(!y)throw Error("Cannot recover signature: point at infinify");return y.assertValidity(),y}}]),e}();function ne(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function te(e){if(e.length<2||2!==e[0])throw Error("Invalid signature integer tag: "+oe(e));var n=e[1],t=e.subarray(2,n+2);if(!n||t.length!==n)throw Error("Invalid signature integer: wrong length");if(0===t[0]&&t[1]<=127)throw Error("Invalid signature integer: trailing length");return{data:ye(t),left:e.subarray(n+2)}}ee.BASE=new ee(Z.Gx,Z.Gy),ee.ZERO=new ee(O,O);var re=function(){"use strict";function e(n,t){(0,A.default)(this,e),this.r=n,this.s=t,this.assertValidity()}return(0,S.default)(e,[{key:"assertValidity",value:function(){var e=this.r,n=this.s;if(!Ee(e))throw Error("Invalid Signature: r must be 0 < r < n");if(!Ee(n))throw Error("Invalid Signature: s must be 0 < s < n")}},{key:"hasHighS",value:function(){var e=Z.n>>N;return this.s>e}},{key:"normalizeS",value:function(){return this.hasHighS()?new e(this.r,me(-this.s,Z.n)):this}},{key:"toDERRawBytes",value:function(){return ve(this.toDERHex())}},{key:"toDERHex",value:function(){var e=ne(de(this.s)),n=ne(de(this.r)),t=e.length/2,r=n.length/2,a=de(t),i=de(r);return"30".concat(de(r+t+4),"02").concat(i).concat(n,"02").concat(a).concat(e)}},{key:"toRawBytes",value:function(){return this.toDERRawBytes()}},{key:"toHex",value:function(){return this.toDERHex()}},{key:"toCompactRawBytes",value:function(){return ve(this.toCompactHex())}},{key:"toCompactHex",value:function(){return se(this.r)+se(this.s)}}],[{key:"fromCompact",value:function(n){var t=n instanceof Uint8Array,r="Signature.fromCompact";if("string"!=typeof n&&!t)throw new TypeError(r+": Expected string or Uint8Array");var a=t?oe(n):n;if(128!==a.length)throw Error(r+": Expected 64-byte hex");return new e(he(a.slice(0,64)),he(a.slice(64,128)))}},{key:"fromDER",value:function(n){var t=n instanceof Uint8Array;if("string"!=typeof n&&!t)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");var r=function(e){if(e.length<2||48!=e[0])throw Error("Invalid signature tag: "+oe(e));if(e[1]!==e.length-2)throw Error("Invalid signature: incorrect length");var n=te(e.subarray(2)),t=n.data,r=te(n.left),a=r.data,i=r.left;if(i.length)throw Error("Invalid signature: left bytes after parsing: "+oe(i));return{r:t,s:a}}(t?n:ve(n));return new e(r.r,r.s)}},{key:"fromHex",value:function(e){return this.fromDER(e)}}]),e}();function ae(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];if(!n.every((function(e){return e instanceof Uint8Array})))throw Error("Uint8Array list expected");if(1===n.length)return n[0];for(var r=n.reduce((function(e,n){return e+n.length}),0),a=new Uint8Array(r),i=0,o=0;i<n.length;i++){var u=n[i];a.set(u,o),o+=u.length}return a}var ie=Array.from({length:256},(function(e,n){return n.toString(16).padStart(2,"0")}));function oe(e){if(!(e instanceof Uint8Array))throw Error("Expected Uint8Array");for(var n="",t=0;t<e.length;t++)n+=ie[e[t]];return n}var ue,ce,fe=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function se(e){if("bigint"!=(void 0===e?"undefined":(0,U.default)(e)))throw Error("Expected bigint");if(!(O<=e&&e<fe))throw Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function le(e){var n=ve(se(e));if(32!==n.length)throw Error("Error: expected 32 bytes");return n}function de(e){var n=e.toString(16);return 1&n.length?"0"+n:n}function he(e){if("string"!=typeof e)throw new TypeError("hexToNumber: expected string, got "+(void 0===e?"undefined":(0,U.default)(e)));return BigInt("0x"+e)}function ve(e){if("string"!=typeof e)throw new TypeError("hexToBytes: expected string, got "+(void 0===e?"undefined":(0,U.default)(e)));if(e.length%2)throw Error("hexToBytes: received invalid unpadded hex"+e.length);for(var n=new Uint8Array(e.length/2),t=0;t<n.length;t++){var r=2*t,a=e.slice(r,r+2),i=Number.parseInt(a,16);if(Number.isNaN(i)||i<0)throw Error("Invalid byte sequence");n[t]=i}return n}function ye(e){return he(oe(e))}function pe(e){return e instanceof Uint8Array?Uint8Array.from(e):ve(e)}function ge(e){if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if("bigint"==(void 0===e?"undefined":(0,U.default)(e))&&Ee(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function me(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.P,t=e%n;return t>=O?t:n+t}function we(e,n){for(var t=Z.P,r=e;n-- >O;)r*=r,r%=t;return r}function be(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.P;if(e===O||n<=O)throw Error("invert: expected positive integers, got n=".concat(e," mod=").concat(n));for(var t=me(e,n),r=n,a=O,i=N;t!==O;){var o=r%t,u=a-i*(r/t);r=t,t=o,a=i,i=u}if(r!==N)throw Error("invert: does not exist");return me(a,n)}function Ee(e){return O<e&&e<Z.n}function ke(e){return O<e&&e<Z.P}function xe(e){var n;if("bigint"==(void 0===e?"undefined":(0,U.default)(e)))n=e;else if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)n=BigInt(e);else if("string"==typeof e){if(64!==e.length)throw Error("Expected 32 bytes of private key");n=he(e)}else{if(!(e instanceof Uint8Array))throw new TypeError("Expected valid private key");if(e.length!==K)throw Error("Expected 32 bytes of private key");n=ye(e)}if(!Ee(n))throw Error("Expected private key: 0 < key < n");return n}function Ae(e){return e instanceof ee?(e.assertValidity(),e):ee.fromHex(e)}function Se(e){return me(ye(e),Z.n)}var _e=function(){"use strict";function e(n,t){(0,A.default)(this,e),this.r=n,this.s=t,this.assertValidity()}return(0,S.default)(e,[{key:"assertValidity",value:function(){var e=this.r,n=this.s;if(!ke(e)||!Ee(n))throw Error("Invalid signature")}},{key:"toHex",value:function(){return se(this.r)+se(this.s)}},{key:"toRawBytes",value:function(){return ve(this.toHex())}}],[{key:"fromHex",value:function(n){var t=pe(n);if(64!==t.length)throw new TypeError("SchnorrSignature.fromHex: expected 64 bytes, not "+t.length);return new e(ye(t.subarray(0,32)),ye(t.subarray(32,64)))}}]),e}(),Ie=function(){"use strict";function e(n,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Le.randomBytes();if((0,A.default)(this,e),null==n)throw new TypeError('sign: Expected valid message, not "'.concat(n,'"'));this.m=pe(n);var a=this.getScalar(xe(t)),i=a.x,o=a.scalar;if(this.px=i,this.d=o,this.rand=pe(r),32!==this.rand.length)throw new TypeError("sign: Expected 32 bytes of aux randomness")}return(0,S.default)(e,[{key:"getScalar",value:function(e){var n=ee.fromPrivateKey(e),t=n.hasEvenY()?e:Z.n-e;return{point:n,scalar:t,x:n.toRawX()}}},{key:"initNonce",value:function(e,n){return le(e^ye(n))}},{key:"finalizeNonce",value:function(e){var n=me(ye(e),Z.n);if(n===O)throw Error("sign: Creation of signature failed. k is zero");var t=this.getScalar(n);return{R:t.point,rx:t.x,k:t.scalar}}},{key:"finalizeSig",value:function(e,n,t,r){return new _e(e.x,me(n+t*r,Z.n)).toRawBytes()}},{key:"error",value:function(){throw Error("sign: Invalid signature produced")}},{key:"calc",value:function(){var e=this;return(0,x.default)((function(){var n,t,r,a,i,o,u,c,f,s,l,d,h,v,y;return(0,D.__generator)(this,(function(p){switch(p.label){case 0:return n=e.m,t=e.d,r=e.px,a=e.rand,i=Le.taggedHash,h=e.initNonce,v=[t],[4,i(Oe.aux,a)];case 1:return o=h.apply(e,v.concat([p.sent()])),y=e.finalizeNonce,[4,i(Oe.nonce,o,r,n)];case 2:return u=y.apply(e,[p.sent()]),c=u.R,f=u.rx,s=u.k,[4,i(Oe.challenge,f,r,n)];case 3:return l=Se.apply(void 0,[p.sent()]),[4,Te(d=e.finalizeSig(c,s,l,t),n,r)];case 4:return[2,(p.sent()||e.error(),d)]}}))}))()}},{key:"calcSync",value:function(){var e=this,n=e.m,t=e.d,r=e.px,a=e.rand,i=Le.taggedHashSync,o=this.initNonce(t,i(Oe.aux,a)),u=this.finalizeNonce(i(Oe.nonce,o,r,n)),c=u.R,f=u.rx,s=u.k,l=Se(i(Oe.challenge,f,r,n)),d=this.finalizeSig(c,s,l,t);return Ue(d,n,r)||this.error(),d}}]),e}();function Pe(e,n,t){var r=e instanceof _e,a=r?e:_e.fromHex(e);return r&&a.assertValidity(),(0,B.default)((0,P.default)({},a),{m:pe(n),P:Ae(t)})}function Be(e,n,t,r){var a=ee.BASE.multiplyAndAddUnsafe(n,xe(t),me(-r,Z.n));return!(!a||!a.hasEvenY()||a.x!==e)}function Te(e,n,t){return He.apply(this,arguments)}function He(){return He=(0,x.default)((function(e,n,t){var r,a,i,o,u,c;return(0,D.__generator)(this,(function(f){switch(f.label){case 0:return f.trys.push([0,2,,3]),r=Pe(e,n,t),a=r.r,i=r.s,o=r.m,u=r.P,[4,Le.taggedHash(Oe.challenge,le(a),u.toRawX(),o)];case 1:return c=Se.apply(void 0,[f.sent()]),[2,Be(a,u,i,c)];case 2:return f.sent(),[2,!1];case 3:return[2]}}))})),He.apply(this,arguments)}function Ue(e,n,t){try{var r=Pe(e,n,t),a=r.r,i=r.s,o=r.m,u=r.P,c=Se(Le.taggedHashSync(Oe.challenge,le(a),u.toRawX(),o));return Be(a,u,i,c)}catch(e){if(e instanceof G)throw e;return!1}}var Re,Ce=function(e){return ee.fromPrivateKey(e).toRawX()},De=function(e,n,t){return(0,x.default)((function(){return(0,D.__generator)(this,(function(r){return[2,new Ie(e,n,t).calc()]}))}))()};ee.BASE._setWindowSize(8);var ze={node:z,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},Oe={challenge:"BIP0340/challenge",aux:"BIP0340/aux",nonce:"BIP0340/nonce"},Ne={},Le=(Re={bytesToHex:oe,hexToBytes:ve,concatBytes:ae,mod:me,invert:be,isValidPrivateKey:function(e){try{return xe(e),!0}catch(e){return!1}},_bigintTo32Bytes:le,_normalizePrivateKey:xe,hashToPrivateKey:function(e){if((e=pe(e)).length<40||e.length>1024)throw Error("Expected valid bytes of private key as per FIPS 186");return le(me(ye(e),Z.n-N)+N)}},(0,_.default)(Re,"randomBytes",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(ze.web)return ze.web.getRandomValues(new Uint8Array(e));if(ze.node){var n=ze.node.randomBytes;return Uint8Array.from(n(e))}throw Error("The environment doesn't have randomBytes function")})),(0,_.default)(Re,"randomPrivateKey",(function(){return Le.hashToPrivateKey(Le.randomBytes(40))})),(0,_.default)(Re,"precompute",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ee.BASE,t=n===ee.BASE?n:new ee(n.x,n.y);return t._setWindowSize(e),t.multiply(j),t})),(0,_.default)(Re,"sha256",(function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return(0,x.default)((function(){var e,t,r,a;return(0,D.__generator)(this,(function(i){switch(i.label){case 0:return ze.web?[4,ze.web.subtle.digest("SHA-256",ae.apply(void 0,(0,H.default)(n)))]:[3,2];case 1:return e=i.sent(),[2,new Uint8Array(e)];case 2:if(ze.node)return t=ze.node,r=t.createHash,a=r("sha256"),[2,(n.forEach((function(e){return a.update(e)})),Uint8Array.from(a.digest()))];throw Error("The environment doesn't have sha256 function")}}))}))()})),(0,_.default)(Re,"hmacSha256",(function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return(0,x.default)((function(){var n,r,a,i,o,u;return(0,D.__generator)(this,(function(c){switch(c.label){case 0:return ze.web?[4,ze.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"])]:[3,3];case 1:return n=c.sent(),r=ae.apply(void 0,(0,H.default)(t)),[4,ze.web.subtle.sign("HMAC",n,r)];case 2:return a=c.sent(),[2,new Uint8Array(a)];case 3:if(ze.node)return i=ze.node,o=i.createHmac,u=o("sha256",e),[2,(t.forEach((function(e){return u.update(e)})),Uint8Array.from(u.digest()))];throw Error("The environment doesn't have hmac-sha256 function")}}))}))()})),(0,_.default)(Re,"sha256Sync",void 0),(0,_.default)(Re,"hmacSha256Sync",void 0),(0,_.default)(Re,"taggedHash",(function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];return(0,x.default)((function(){var n,r,a;return(0,D.__generator)(this,(function(i){switch(i.label){case 0:return void 0!==(r=Ne[e])?[3,2]:[4,Le.sha256(Uint8Array.from(e,(function(e){return e.charCodeAt(0)})))];case 1:a=i.sent(),r=ae(a,a),Ne[e]=r,i.label=2;case 2:return[2,(n=Le).sha256.apply(n,[r].concat((0,H.default)(t)))]}}))}))()})),(0,_.default)(Re,"taggedHashSync",(function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];if("function"!=typeof ue)throw new G("sha256Sync is undefined, you need to set it");var a=Ne[e];if(void 0===a){var i=ue(Uint8Array.from(e,(function(e){return e.charCodeAt(0)})));a=ae(i,i),Ne[e]=a}return ue.apply(void 0,[a].concat((0,H.default)(t)))})),(0,_.default)(Re,"_JacobianPoint",Y),Re);Object.defineProperties(Le,{sha256Sync:{configurable:!1,get:function(){return ue},set:function(e){ue||(ue=e)}},hmacSha256Sync:{configurable:!1,get:function(){return ce},set:function(e){ce||(ce=e)}}});var je,Me,Ze,Ve=Math.floor,qe=Math.random,We=Math.sin,Ke="Trystero",Fe=function(e,n){return Array(e).fill().map(n)},Je=function(e){return Fe(e,(function(){return"0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz"[Ve(62*qe())]})).join("")},Ge=Je(20),Xe=Promise.all.bind(Promise),Ye="undefined"!=typeof window,Qe=Object.entries,$e=Object.fromEntries,en=Object.keys,nn=function(){},tn=function(e){return Error("".concat(Ke,": ").concat(e))},rn=new TextEncoder,an=new TextDecoder,on=function(e){return rn.encode(e)},un=function(e){return an.decode(e)},cn=function(e){return e.reduce((function(e,n){return e+n.toString(16).padStart(2,"0")}),"")},fn=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.join("@")},sn=JSON.stringify,ln=JSON.parse,dn=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_SAFE_INTEGER;return e.split("").reduce((function(e,n){return e+n.charCodeAt(0)}),0)%n},hn={},vn="AES-GCM",yn={},pn=(je=(0,x.default)((function(e){var n,t,r;return(0,D.__generator)(this,(function(a){switch(a.label){case 0:return(n=yn[e])?[3,2]:(t=Array.from,r=Uint8Array.bind,[4,crypto.subtle.digest("SHA-1",on(e))]);case 1:n=yn[e]=t.apply(Array,[new(r.apply(Uint8Array,[void 0,a.sent()]))]).map((function(e){return e.toString(36)})).join(""),a.label=2;case 2:return[2,n]}}))})),function(e){return je.apply(this,arguments)}),gn=function(){var e=(0,x.default)((function(e,n){var t,r,a,i,o,u;return(0,D.__generator)(this,(function(c){switch(c.label){case 0:return t=crypto.getRandomValues(new Uint8Array(16)),a=t.join(",")+"$",o=(i=crypto.subtle).encrypt,u=[{name:vn,iv:t}],[4,e];case 1:return[4,o.apply(i,u.concat([c.sent(),on(n)]))];case 2:return[2,a+(r=c.sent(),btoa(String.fromCharCode.apply(null,new Uint8Array(r))))]}}))}));return function(n,t){return e.apply(this,arguments)}}(),mn=function(){var e=(0,x.default)((function(e,n){var t,r,a,i,o,u;return(0,D.__generator)(this,(function(c){switch(c.label){case 0:return t=(0,T.default)(n.split("$"),2),r=t[0],a=t[1],o=(i=crypto.subtle).decrypt,u=[{name:vn,iv:new Uint8Array(r.split(","))}],[4,e];case 1:return[4,o.apply(i,u.concat([c.sent(),function(e){var n=atob(e);return new Uint8Array(n.length).map((function(e,t){return n.charCodeAt(t)})).buffer}(a)]))];case 2:return[2,un.apply(void 0,[c.sent()])]}}))}));return function(n,t){return e.apply(this,arguments)}}(),wn="icegatheringstatechange",bn="offer",En=function(e,n){var t=n.rtcConfig,r=n.rtcPolyfill,a=n.turnConfig,i=new(r||RTCPeerConnection)((0,P.default)({iceServers:kn.concat(a||[])},t)),o={},u=!1,c=!1,f=null,s=function(e){e.binaryType="arraybuffer",e.bufferedAmountLowThreshold=65535,e.onmessage=function(e){var n;return null===(n=o.data)||void 0===n?void 0:n.call(o,e.data)},e.onopen=function(){var e;return null===(e=o.connect)||void 0===e?void 0:e.call(o)},e.onclose=function(){var e;return null===(e=o.close)||void 0===e?void 0:e.call(o)},e.onerror=function(e){var n;return null===(n=o.error)||void 0===n?void 0:n.call(o,e)}},l=function(e){return Promise.race([new Promise((function(n){var t=function(){"complete"===e.iceGatheringState&&(e.removeEventListener(wn,t),n())};e.addEventListener(wn,t),t()})),new Promise((function(e){return setTimeout(e,5e3)}))]).then((function(){return{type:e.localDescription.type,sdp:e.localDescription.sdp.replace(/a=ice-options:trickle\s\n/g,"")}}))};return e?(f=i.createDataChannel("data"),s(f)):i.ondatachannel=function(e){var n=e.channel;f=n,s(n)},i.onnegotiationneeded=(0,x.default)((function(){var e,n,t,r;return(0,D.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,4,5]),u=!0,[4,i.setLocalDescription()];case 1:return a.sent(),[4,l(i)];case 2:return n=a.sent(),null===(e=o.signal)||void 0===e||e.call(o,n),[3,5];case 3:return t=a.sent(),null===(r=o.error)||void 0===r||r.call(o,t),[3,5];case 4:return u=!1,[7];case 5:return[2]}}))})),i.onconnectionstatechange=function(){var e;["disconnected","failed","closed"].includes(i.connectionState)&&(null===(e=o.close)||void 0===e||e.call(o))},i.ontrack=function(e){var n,t;null===(n=o.track)||void 0===n||n.call(o,e.track,e.streams[0]),null===(t=o.stream)||void 0===t||t.call(o,e.streams[0])},i.onremovestream=function(e){var n;return null===(n=o.stream)||void 0===n?void 0:n.call(o,e.stream)},e&&(i.canTrickleIceCandidates||i.onnegotiationneeded()),{created:Date.now(),connection:i,get channel(){return f},get isDead(){return"closed"===i.connectionState},signal:function(n){return(0,x.default)((function(){var t,r,a,s,d;return(0,D.__generator)(this,(function(h){switch(h.label){case 0:if("open"===(null==f?void 0:f.readyState)&&!(null===(t=n.sdp)||void 0===t?void 0:t.includes("a=rtpmap")))return[3,14];h.label=1;case 1:return h.trys.push([1,13,,14]),n.type!==bn?[3,8]:u||"stable"!==i.signalingState&&!c?e?[2]:[4,Xe([i.setLocalDescription({type:"rollback"}),i.setRemoteDescription(n)])]:[3,3];case 2:return h.sent(),[3,5];case 3:return[4,i.setRemoteDescription(n)];case 4:h.sent(),h.label=5;case 5:return[4,i.setLocalDescription()];case 6:return h.sent(),[4,l(i)];case 7:return a=h.sent(),[2,(null===(r=o.signal)||void 0===r||r.call(o,a),a)];case 8:if("answer"!==n.type)return[3,12];c=!0,h.label=9;case 9:return h.trys.push([9,,11,12]),[4,i.setRemoteDescription(n)];case 10:return h.sent(),[3,12];case 11:return c=!1,[7];case 12:return[3,14];case 13:return s=h.sent(),null===(d=o.error)||void 0===d||d.call(o,s),[3,14];case 14:return[2]}}))}))()},sendData:function(e){return f.send(e)},destroy:function(){null==f||f.close(),i.close(),u=!1,c=!1},setHandlers:function(e){return Object.assign(o,e)},offerPromise:e?new Promise((function(e){return o.signal=function(n){n.type===bn&&e(n)}})):Promise.resolve(),addStream:function(e){return e.getTracks().forEach((function(n){return i.addTrack(n,e)}))},removeStream:function(e){return i.getSenders().filter((function(n){return e.getTracks().includes(n.track)})).forEach((function(e){return i.removeTrack(e)}))},addTrack:function(e,n){return i.addTrack(e,n)},removeTrack:function(e){var n=i.getSenders().find((function(n){return n.track===e}));n&&i.removeTrack(n)},replaceTrack:function(e,n){var t=i.getSenders().find((function(n){return n.track===e}));if(t)return t.replaceTrack(n)}}},kn=(0,H.default)(Fe(3,(function(e,n){return"stun:stun".concat(n||"",".l.google.com:19302")}))).concat(["stun:stun.cloudflare.com:3478"]).map((function(e){return{urls:e}})),xn=Object.getPrototypeOf(Uint8Array),An=16369,Sn=255,_n="bufferedamountlow",In=function(e){return"@_"+e},Pn={},Bn="EVENT",Tn=Le.randomPrivateKey(),Hn=cn(Ce(Tn)),Un={},Rn={},Cn={},Dn=function(){return Math.floor(Date.now()/1e3)},zn=function(e){return null!==(Me=(u=Cn)[c=e])&&void 0!==Me?Me:u[c]=dn(e,1e4)+2e4},On=function(){var e=(0,x.default)((function(e,n){var t,r,a,i,o,u;return(0,D.__generator)(this,(function(c){switch(c.label){case 0:return t={kind:zn(e),content:n,pubkey:Hn,created_at:Dn(),tags:[["x",e]]},a=Uint8Array.bind,[4,crypto.subtle.digest("SHA-256",on(sn([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])))];case 1:return r=cn.apply(void 0,[new(a.apply(Uint8Array,[void 0,c.sent()]))]),i=[Bn],o=[(0,P.default)({},t)],u={id:r},[4,De(r,Tn)];case 2:return[2,sn.apply(void 0,[i.concat([B.default.apply(void 0,o.concat([(u.sig=cn.apply(void 0,[c.sent()]),u)]))])])]}}))}));return function(n,t){return e.apply(this,arguments)}}(),Nn=function(e,n){return Un[e]=n,sn(["REQ",e,{kinds:[zn(n)],since:Dn(),"#x":[n]}])},Ln=function(e){return delete Un[e],sn(["CLOSE",e])},jn=function(e){var n,t,r,a=e.init,i=e.subscribe,o=e.announce,u={},c=!1;return function(e,E,k){var A,S,_=e.appId;if(null===(S=u[_])||void 0===S?void 0:S[E])return u[_][E];var I={},R={},C=fn(Ke,_,E),z=pn(C),O=pn(fn(C,Ge)),N=function(){var e=(0,x.default)((function(e,n,t){var r,a,i;return(0,D.__generator)(this,(function(o){switch(o.label){case 0:return a=(r=crypto.subtle).importKey,i=["raw"],[4,crypto.subtle.digest({name:"SHA-256"},on("".concat(e,":").concat(n,":").concat(t)))];case 1:return[2,a.apply(r,i.concat([o.sent(),{name:vn},!1,["encrypt","decrypt"]]))]}}))}));return function(n,t,r){return e.apply(this,arguments)}}()(e.password||"",_,E),L=function(e){return function(){var n=(0,x.default)((function(n){var t;return(0,D.__generator)(this,(function(r){switch(r.label){case 0:return t={type:n.type},[4,e(N,n.sdp)];case 1:return[2,(t.sdp=r.sent(),t)]}}))}));return function(e){return n.apply(this,arguments)}}()},j=L(mn),M=L(gn),Z=function(){return En(!0,e)},V=function(e,n,t){var r;R[n]?R[n]!==e&&e.destroy():(R[n]=e,Q(e,n),null===(r=I[n])||void 0===r||r.forEach((function(e,n){n!==t&&e.destroy()})),delete I[n])},q=function(e,n){R[n]===e&&delete R[n]},W=function(e){return(A=t).push.apply(A,(0,H.default)(Fe(e,Z))),Xe(t.splice(0,e).map((function(e){return e.offerPromise.then(M).then((function(n){return{peer:e,offer:n}}))})))},K=function(n,t){return null==k?void 0:k({error:"incorrect password (".concat(e.password,") when decrypting ").concat(t),appId:_,peerId:n,roomId:E})},F=function(n){return function(){var t=(0,x.default)((function(t,r,a){var i,o,u,c,l,d,h,v,y,p,g,m,w,b,E,k,x,A,S,_,P,B,H,U,N,L;return(0,D.__generator)(this,(function(D){switch(D.label){case 0:return[4,Xe([z,O])];case 1:if(i=T.default.apply(void 0,[D.sent(),2]),o=i[0],u=i[1],t!==o&&t!==u)return[2];if(c="string"==typeof r?ln(r):r,l=c.peerId,d=c.offer,h=c.answer,v=c.peer,l===Ge||R[l])return[3,16];if(l&&!d&&!h)return[3,14];if(!d)return[3,8];if((null===(y=I[l])||void 0===y?void 0:y[n])&&Ge>l)return[2];(p=En(!1,e)).setHandlers({connect:function(){return V(p,l,n)},close:function(){return q(p,l)}}),D.label=2;case 2:return D.trys.push([2,4,,5]),[4,j(d)];case 3:return g=D.sent(),[3,5];case 4:return D.sent(),[2,void K(l,"offer")];case 5:return p.isDead?[2]:[4,Xe([pn(fn(C,l)),p.signal(g)])];case 6:return m=T.default.apply(void 0,[D.sent(),2]),w=m[0],b=m[1],E=[w],k={peerId:Ge},[4,M(b)];case 7:return a.apply(void 0,E.concat([sn.apply(void 0,[(k.answer=D.sent(),k)])])),[3,13];case 8:if(!h)return[3,13];D.label=9;case 9:return D.trys.push([9,11,,12]),[4,j(h)];case 10:return x=D.sent(),[3,12];case 11:return D.sent(),[2,void K(l,"answer")];case 12:v?(v.setHandlers({connect:function(){return V(v,l,n)},close:function(){return q(v,l)}}),v.signal(x)):(S=null===(A=I[l])||void 0===A?void 0:A[n])&&!S.isDead&&S.signal(x),D.label=13;case 13:return[3,16];case 14:return(null===(_=I[l])||void 0===_?void 0:_[n])?[2]:[4,Xe([W(1),pn(fn(C,l))])];case 15:P=T.default.apply(void 0,[D.sent(),2]),B=(0,T.default)(P[0],1),H=B[0],U=H.peer,N=H.offer,L=P[1],(f=I)[s=l]||(f[s]=[]),I[l][n]=U,setTimeout((function(){return function(e,n){var t;if(!R[e]){var r=null===(t=I[e])||void 0===t?void 0:t[n];r&&(delete I[e][n],r.destroy())}}(l,n)}),.9*G[n]),U.setHandlers({connect:function(){return V(U,l,n)},close:function(){return q(U,l)}}),a(L,sn({peerId:Ge,offer:N})),D.label=16;case 16:return[2]}}))}));return function(e,n,r){return t.apply(this,arguments)}}()};if(!e)throw tn("requires a config map as the first argument");if(!_&&!e.firebaseApp)throw tn("config map is missing appId field");if(!E)throw tn("roomId argument required");if(!c){var J=a(e);t=Fe(20,Z),n=Array.isArray(J)?J:[J],c=!0,r=setInterval((function(){return t=t.filter((function(e){var n=Date.now()-e.created<57333;return n||e.destroy(),n}))}),59052.99)}var G=n.map((function(){return 5333})),X=[],Y=n.map(function(){var e=(0,x.default)((function(e,n){var t;return(0,D.__generator)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return t=[r.sent()],[4,z];case 2:return t=t.concat(r.sent()),[4,O];case 3:return[2,i.apply(void 0,t.concat([r.sent(),F(n),W]))]}}))}));return function(n,t){return e.apply(this,arguments)}}());Xe([z,O]).then((function(e){var t=(0,T.default)(e,2),r=t[0],a=t[1],i=function(){var e=(0,x.default)((function(e,n){var t;return(0,D.__generator)(this,(function(u){switch(u.label){case 0:return[4,o(e,r,a)];case 1:return"number"==typeof(t=u.sent())&&(G[n]=t),X[n]=setTimeout((function(){return i(e,n)}),G[n]),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}();Y.forEach(function(){var e=(0,x.default)((function(e,t){return(0,D.__generator)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return r.sent(),[4,n[t]];case 2:return i.apply(void 0,[r.sent(),t]),[2]}}))}));return function(n,t){return e.apply(this,arguments)}}())}));var Q=nn;return(l=u)[d=_]||(l[d]={}),u[_][E]=function(e,n,t){var r={},a={},i={},o={},u={},c={},f={},s={onPeerJoin:nn,onPeerLeave:nn,onPeerStream:nn,onPeerTrack:nn},l=function(e,n){return(e?Array.isArray(e)?e:[e]:en(r)).flatMap((function(e){var t=r[e];return t?n(e,t):(console.warn("".concat(Ke,": no peer with id ").concat(e," found")),[])}))},d=function(e){r[e]&&(delete r[e],delete o[e],delete u[e],s.onPeerLeave(e),n(e))},E=function(e){if(a[e])return i[e];if(!e)throw tn("action type argument is required");var n=on(e);if(n.byteLength>12)throw tn('action type string "'.concat(e,'" (').concat(n.byteLength,"b) exceeds byte limit (12). Hint: choose a shorter name."));var t=new Uint8Array(12);t.set(n);var o=0;return a[e]={onComplete:nn,onProgress:nn,setOnComplete:function(n){return a[e]=(0,B.default)((0,P.default)({},a[e]),{onComplete:n})},setOnProgress:function(n){return a[e]=(0,B.default)((0,P.default)({},a[e]),{onProgress:n})},send:function(e,n,a,i){return(0,x.default)((function(){var u,c,f,s,d,h,v,y,p,g,m;return(0,D.__generator)(this,(function(w){switch(w.label){case 0:if(a&&"object"!=typeof a)throw tn("action meta argument must be an object");if("undefined"===(u=void 0===e?"undefined":(0,U.default)(e)))throw tn("action data cannot be undefined");if(c="string"!==u,f=e instanceof Blob,s=f||e instanceof ArrayBuffer||e instanceof xn,a&&!s)throw tn("action meta argument can only be used with binary data");return s?(g=Uint8Array.bind,f?[4,e.arrayBuffer()]:[3,2]):[3,4];case 1:return m=w.sent(),[3,3];case 2:m=e,w.label=3;case 3:return p=new(g.apply(Uint8Array,[void 0,m])),[3,5];case 4:p=on(c?sn(e):e),w.label=5;case 5:return d=p,h=a?on(sn(a)):null,v=Math.ceil(d.byteLength/An)+(a?1:0)||1,y=Fe(v,(function(e,n){var r=n===v-1,i=a&&0===n,u=new Uint8Array(15+(i?h.byteLength:r?d.byteLength-An*(v-(a?2:1)):An));return u.set(t),u.set([o],12),u.set([r|i<<1|s<<2|c<<3],13),u.set([Math.round((n+1)/v*Sn)],14),u.set(a?i?h:d.subarray((n-1)*An,n*An):d.subarray(n*An,(n+1)*An),15),u})),[2,(o=o+1&Sn,Xe(l(n,function(){var e=(0,x.default)((function(e,n){var t,o,u;return(0,D.__generator)(this,(function(c){switch(c.label){case 0:t=n.channel,o=0,c.label=1;case 1:return o<v?(u=y[o],t.bufferedAmount>t.bufferedAmountLowThreshold?[4,new Promise((function(e){var n=function(){t.removeEventListener(_n,n),e()};t.addEventListener(_n,n)}))]:[3,3]):[3,5];case 2:c.sent(),c.label=3;case 3:if(!r[e])return[3,5];n.sendData(u),o++,null==i||i(u[14]/Sn,e,a),c.label=4;case 4:return[3,1];case 5:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}())))]}}))}))()}},(h=i)[v=e]||(h[v]=[a[e].send,a[e].setOnComplete,a[e].setOnProgress])},k=function(e,n){var t=new Uint8Array(n),r=un(t.subarray(0,12)).replaceAll("\0",""),i=(0,T.default)(t.subarray(12,13),1)[0],u=(0,T.default)(t.subarray(13,14),1)[0],c=(0,T.default)(t.subarray(14,15),1)[0],f=t.subarray(15),s=!!(1&u),l=!!(2&u),d=!!(4&u),h=!!(8&u);if(a[r]){(y=o)[p=e]||(y[p]={}),(g=o[e])[m=r]||(g[m]={});var v=(w=o[e][r])[b=i]||(w[b]={chunks:[]});if(l?v.meta=ln(un(f)):v.chunks.push(f),a[r].onProgress(c/Sn,e,v.meta),s){var E=new Uint8Array(v.chunks.reduce((function(e,n){return e+n.byteLength}),0));if(v.chunks.reduce((function(e,n){return E.set(n,e),e+n.byteLength}),0),delete o[e][r][i],d)a[r].onComplete(E,e,v.meta);else{var k=un(E);a[r].onComplete(h?ln(k):k,e)}}}else console.warn("".concat(Ke,": received message with unregistered type (").concat(r,")"))},A=function(){var e=(0,x.default)((function(){return(0,D.__generator)(this,(function(e){switch(e.label){case 0:return[4,K("")];case 1:return e.sent(),[4,new Promise((function(e){return setTimeout(e,99)}))];case 2:return e.sent(),Qe(r).forEach((function(e){var n=(0,T.default)(e,2),t=n[0];n[1].destroy(),delete r[t]})),t(),[2]}}))}));return function(){return e.apply(this,arguments)}}(),S=(0,T.default)(E(In("ping")),2),_=S[0],I=S[1],H=(0,T.default)(E(In("pong")),2),R=H[0],C=H[1],z=(0,T.default)(E(In("signal")),2),O=z[0],N=z[1],L=(0,T.default)(E(In("stream")),2),j=L[0],M=L[1],Z=(0,T.default)(E(In("track")),2),V=Z[0],q=Z[1],W=(0,T.default)(E(In("leave")),2),K=W[0],F=W[1];return function(e){Q=e}((function(e,n){var t;r[n]||(r[n]=e,e.setHandlers({data:function(e){return k(n,e)},stream:function(e){s.onPeerStream(e,n,c[n]),delete c[n]},track:function(e,t){s.onPeerTrack(e,t,n,f[n]),delete f[n]},signal:function(e){return O(e,n)},close:function(){return d(n)},error:function(e){console.error(e),d(n)}}),s.onPeerJoin(n),null===(t=e.drainEarlyData)||void 0===t||t.call(e,(function(e){return k(n,e)})))})),I((function(e,n){return R("",n)})),C((function(e,n){var t;null===(t=u[n])||void 0===t||t.call(u),delete u[n]})),N((function(e,n){var t;return null===(t=r[n])||void 0===t?void 0:t.signal(e)})),M((function(e,n){return c[n]=e})),q((function(e,n){return f[n]=e})),F((function(e,n){return d(n)})),Ye&&addEventListener("beforeunload",A),{makeAction:E,leave:A,ping:function(e){return(0,x.default)((function(){var n;return(0,D.__generator)(this,(function(t){switch(t.label){case 0:if(!e)throw tn("ping() must be called with target peer ID");return n=Date.now(),_("",e),[4,new Promise((function(n){return u[e]=n}))];case 1:return[2,(t.sent(),Date.now()-n)]}}))}))()},getPeers:function(){return $e(Qe(r).map((function(e){var n=(0,T.default)(e,2);return[n[0],n[1].connection]})))},addStream:function(e,n,t){return l(n,function(){var n=(0,x.default)((function(n,r){return(0,D.__generator)(this,(function(a){switch(a.label){case 0:return t?[4,j(t,n)]:[3,2];case 1:a.sent(),a.label=2;case 2:return r.addStream(e),[2]}}))}));return function(e,t){return n.apply(this,arguments)}}())},removeStream:function(e,n){return l(n,(function(n,t){return t.removeStream(e)}))},addTrack:function(e,n,t,r){return l(t,function(){var t=(0,x.default)((function(t,a){return(0,D.__generator)(this,(function(i){switch(i.label){case 0:return r?[4,V(r,t)]:[3,2];case 1:i.sent(),i.label=2;case 2:return a.addTrack(e,n),[2]}}))}));return function(e,n){return t.apply(this,arguments)}}())},removeTrack:function(e,n){return l(n,(function(n,t){return t.removeTrack(e)}))},replaceTrack:function(e,n,t,r){return l(t,function(){var t=(0,x.default)((function(t,a){return(0,D.__generator)(this,(function(i){switch(i.label){case 0:return r?[4,V(r,t)]:[3,2];case 1:i.sent(),i.label=2;case 2:return a.replaceTrack(e,n),[2]}}))}));return function(e,n){return t.apply(this,arguments)}}())},onPeerJoin:function(e){return s.onPeerJoin=e},onPeerLeave:function(e){return s.onPeerLeave=e},onPeerStream:function(e){return s.onPeerStream=e},onPeerTrack:function(e){return s.onPeerTrack=e}}}(0,(function(e){return delete R[e]}),(function(){delete u[_][E],X.forEach(clearTimeout),Y.forEach(function(){var e=(0,x.default)((function(e){return(0,D.__generator)(this,(function(n){switch(n.label){case 0:return[4,e];case 1:return[2,n.sent()()]}}))}));return function(n){return e.apply(this,arguments)}}()),clearInterval(r)}))}}({init:function(e){return function(e,n,t){return(e.relayUrls||function(e,n){for(var t=(0,H.default)(e),r=function(){var e=1e4*We(n++);return e-Ve(e)},a=t.length;a;){var i,o=Ve(r()*a--);i=[t[o],t[a]],t[a]=i[0],t[o]=i[1]}return t}(n,dn(e.appId))).slice(0,e.relayUrls?e.relayUrls.length:e.relayRedundancy||t)}(e,Mn,5).map((function(e){var n=function(e,n){var t={},r=function(){var a=new WebSocket(e);a.onclose=function(){var n;null!==(n=(E=hn)[k=e])&&void 0!==n||(E[k]=3333),setTimeout(r,hn[e]),hn[e]*=2},a.onmessage=function(e){return n(e.data)},t.socket=a,t.url=a.url,t.ready=new Promise((function(n){return a.onopen=function(){n(t),hn[e]=3333}})),t.send=function(e){1===a.readyState&&a.send(e)}};return r(),t}(e,(function(e){var t,r=(0,T.default)(ln(e),4),a=r[0],i=r[1],o=r[2],u=r[3];if(a===Bn)null===(t=Rn[i])||void 0===t||t.call(Rn,Un[i],o.content);else{var c="".concat(Ke,": relay failure from ").concat(n.url," - ");"NOTICE"===a?console.warn(c+i):"OK"!==a||o||console.warn(c+u)}}));return Pn[e]=n,n.ready}))},subscribe:function(e,n,t,r){var a=Je(64),i=Je(64);return Rn[a]=Rn[i]=function(n,t){return r(n,t,function(){var n=(0,x.default)((function(n,t){var r;return(0,D.__generator)(this,(function(a){switch(a.label){case 0:return r=e.send,[4,On(n,t)];case 1:return[2,r.apply(e,[a.sent()])]}}))}));return function(e,t){return n.apply(this,arguments)}}())},e.send(Nn(a,n)),e.send(Nn(i,t)),function(){e.send(Ln(a)),e.send(Ln(i)),delete Rn[a],delete Rn[i]}},announce:function(e,n){return(0,x.default)((function(){var t;return(0,D.__generator)(this,(function(r){switch(r.label){case 0:return t=e.send,[4,On(n,sn({peerId:Ge}))];case 1:return[2,t.apply(e,[r.sent()])]}}))}))()}}),Mn=(Ze=Pn,["eu.purplerelay.com","ftp.halifax.rwth-aachen.de/nostr","multiplexer.huszonegy.world","nostr.cool110.xyz","nostr.data.haus","nostr.grooveix.com","nostr.huszonegy.world","nostr.mom","nostr.sathoarder.com","nostr.vulpem.com","relay.fountain.fm","relay.nostraddress.com","relay.nostromo.social","relay.snort.social","relay.verified-nostr.com","yabu.me/v2"].map((function(e){return"wss://"+e})))}))}();